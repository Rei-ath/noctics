<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.1 (0)
 -->
<!-- Title: InferenceStep Pages: 1 -->
<svg width="2448pt" height="596pt"
 viewBox="0.00 0.00 2448.00 596.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 591.91)">
<title>InferenceStep</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-591.91 2444.2,-591.91 2444.2,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_hardware</title>
<polygon fill="none" stroke="gray" stroke-dasharray="5,2" points="12.93,-387.91 12.93,-486.91 300.61,-486.91 300.61,-387.91 12.93,-387.91"/>
<text xml:space="preserve" text-anchor="middle" x="156.77" y="-469.61" font-family="Times,serif" font-size="14.00">Hardware (Android/Termux)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_timeline</title>
<polygon fill="none" stroke="black" points="39.46,-496.91 39.46,-579.91 998.08,-579.91 998.08,-496.91 39.46,-496.91"/>
<text xml:space="preserve" text-anchor="middle" x="518.77" y="-562.61" font-family="Times,serif" font-size="14.00">Step Timeline</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_decode</title>
<path fill="none" stroke="blue" d="M20,-53.91C20,-53.91 2420.2,-53.91 2420.2,-53.91 2426.2,-53.91 2432.2,-59.91 2432.2,-65.91 2432.2,-65.91 2432.2,-367.91 2432.2,-367.91 2432.2,-373.91 2426.2,-379.91 2420.2,-379.91 2420.2,-379.91 20,-379.91 20,-379.91 14,-379.91 8,-373.91 8,-367.91 8,-367.91 8,-65.91 8,-65.91 8,-59.91 14,-53.91 20,-53.91"/>
<text xml:space="preserve" text-anchor="middle" x="1220.1" y="-362.61" font-family="Times,serif" font-size="14.00">Decode Step (Single Token)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer</title>
<polygon fill="lightgrey" stroke="lightgrey" points="356.61,-61.91 356.61,-247.91 1798.11,-247.91 1798.11,-61.91 356.61,-61.91"/>
<text xml:space="preserve" text-anchor="middle" x="1077.36" y="-230.61" font-family="Times,serif" font-size="14.00">Transformer Block (x32)</text>
</g>
<!-- RAM -->
<g id="node1" class="node">
<title>RAM</title>
<path fill="lightgrey" stroke="black" d="M292.61,-448.82C292.61,-451.75 270.7,-454.13 243.73,-454.13 216.77,-454.13 194.86,-451.75 194.86,-448.82 194.86,-448.82 194.86,-401.01 194.86,-401.01 194.86,-398.08 216.77,-395.69 243.73,-395.69 270.7,-395.69 292.61,-398.08 292.61,-401.01 292.61,-401.01 292.61,-448.82 292.61,-448.82"/>
<path fill="none" stroke="black" d="M292.61,-448.82C292.61,-445.89 270.7,-443.51 243.73,-443.51 216.77,-443.51 194.86,-445.89 194.86,-448.82"/>
<text xml:space="preserve" text-anchor="middle" x="243.73" y="-428.86" font-family="Helvetica,sans-Serif" font-size="14.00">LPDDR RAM</text>
<text xml:space="preserve" text-anchor="middle" x="243.73" y="-411.61" font-family="Helvetica,sans-Serif" font-size="14.00">(Shared)</text>
</g>
<!-- CPU -->
<g id="node2" class="node">
<title>CPU</title>
<polygon fill="salmon" stroke="black" points="116.43,-446.16 20.93,-446.16 20.93,-442.16 16.93,-442.16 16.93,-438.16 20.93,-438.16 20.93,-411.66 16.93,-411.66 16.93,-407.66 20.93,-407.66 20.93,-403.66 116.43,-403.66 116.43,-446.16"/>
<polyline fill="none" stroke="black" points="20.93,-442.16 24.93,-442.16 24.93,-438.16 20.93,-438.16"/>
<polyline fill="none" stroke="black" points="20.93,-411.66 24.93,-411.66 24.93,-407.66 20.93,-407.66"/>
<text xml:space="preserve" text-anchor="middle" x="68.68" y="-428.86" font-family="Helvetica,sans-Serif" font-size="14.00">CPU Cores</text>
<text xml:space="preserve" text-anchor="middle" x="68.68" y="-411.61" font-family="Helvetica,sans-Serif" font-size="14.00">(4 Threads)</text>
</g>
<!-- CPU&#45;&gt;RAM -->
<g id="edge1" class="edge">
<title>CPU&#45;&gt;RAM</title>
<path fill="none" stroke="black" stroke-width="2" d="M127.91,-424.91C145.71,-424.91 165.31,-424.91 183.19,-424.91"/>
<polygon fill="black" stroke="black" stroke-width="2" points="129.54,-421.41 119.54,-424.91 129.54,-428.41 129.54,-421.41"/>
<polygon fill="black" stroke="black" stroke-width="2" points="181.63,-428.41 191.63,-424.91 181.63,-421.41 181.63,-428.41"/>
<text xml:space="preserve" text-anchor="middle" x="158.11" y="-428.16" font-family="Helvetica,sans-Serif" font-size="10.00">30 GB/s</text>
</g>
<!-- t0 -->
<g id="node3" class="node">
<title>t0</title>
<ellipse fill="white" stroke="black" cx="68.68" cy="-525.91" rx="21.22" ry="21.22"/>
<text xml:space="preserve" text-anchor="middle" x="68.68" y="-521.24" font-family="Helvetica,sans-Serif" font-size="14.00">t0</text>
</g>
<!-- t1 -->
<g id="node4" class="node">
<title>t1</title>
<ellipse fill="white" stroke="black" cx="243.73" cy="-525.91" rx="21.22" ry="21.22"/>
<text xml:space="preserve" text-anchor="middle" x="243.73" y="-521.24" font-family="Helvetica,sans-Serif" font-size="14.00">t1</text>
</g>
<!-- t0&#45;&gt;t1 -->
<!-- t2 -->
<g id="node5" class="node">
<title>t2</title>
<ellipse fill="white" stroke="black" cx="406.73" cy="-525.91" rx="21.22" ry="21.22"/>
<text xml:space="preserve" text-anchor="middle" x="406.73" y="-521.24" font-family="Helvetica,sans-Serif" font-size="14.00">t2</text>
</g>
<!-- t1&#45;&gt;t2 -->
<!-- t3 -->
<g id="node6" class="node">
<title>t3</title>
<ellipse fill="white" stroke="black" cx="558.86" cy="-525.91" rx="21.22" ry="21.22"/>
<text xml:space="preserve" text-anchor="middle" x="558.86" y="-521.24" font-family="Helvetica,sans-Serif" font-size="14.00">t3</text>
</g>
<!-- t2&#45;&gt;t3 -->
<!-- t4 -->
<g id="node7" class="node">
<title>t4</title>
<ellipse fill="white" stroke="black" cx="770.61" cy="-525.91" rx="21.22" ry="21.22"/>
<text xml:space="preserve" text-anchor="middle" x="770.61" y="-521.24" font-family="Helvetica,sans-Serif" font-size="14.00">t4</text>
</g>
<!-- t3&#45;&gt;t4 -->
<!-- t5 -->
<g id="node8" class="node">
<title>t5</title>
<ellipse fill="white" stroke="black" cx="968.86" cy="-525.91" rx="21.22" ry="21.22"/>
<text xml:space="preserve" text-anchor="middle" x="968.86" y="-521.24" font-family="Helvetica,sans-Serif" font-size="14.00">t5</text>
</g>
<!-- t4&#45;&gt;t5 -->
<!-- InputID -->
<g id="node9" class="node">
<title>InputID</title>
<ellipse fill="white" stroke="black" cx="68.68" cy="-195.91" rx="52.68" ry="52.68"/>
<text xml:space="preserve" text-anchor="middle" x="68.68" y="-199.86" font-family="Helvetica,sans-Serif" font-size="14.00">Token ID</text>
<text xml:space="preserve" text-anchor="middle" x="68.68" y="-182.61" font-family="Helvetica,sans-Serif" font-size="14.00">(i32)</text>
</g>
<!-- Embedding -->
<g id="node10" class="node">
<title>Embedding</title>
<polygon fill="lightyellow" stroke="black" points="291.48,-217.16 195.98,-217.16 195.98,-174.66 291.48,-174.66 291.48,-217.16"/>
<text xml:space="preserve" text-anchor="middle" x="243.73" y="-199.86" font-family="Helvetica,sans-Serif" font-size="14.00">Embedding</text>
<text xml:space="preserve" text-anchor="middle" x="243.73" y="-182.61" font-family="Helvetica,sans-Serif" font-size="14.00">Lookup</text>
</g>
<!-- InputID&#45;&gt;Embedding -->
<g id="edge7" class="edge">
<title>InputID&#45;&gt;Embedding</title>
<path fill="none" stroke="black" d="M121.6,-195.91C141.33,-195.91 163.94,-195.91 184.24,-195.91"/>
<polygon fill="black" stroke="black" points="184.05,-199.41 194.05,-195.91 184.05,-192.41 184.05,-199.41"/>
<text xml:space="preserve" text-anchor="middle" x="158.11" y="-199.16" font-family="Helvetica,sans-Serif" font-size="10.00">1x1</text>
</g>
<!-- Embedding&#45;&gt;RAM -->
<g id="edge28" class="edge">
<title>Embedding&#45;&gt;RAM</title>
<path fill="none" stroke="grey" stroke-dasharray="1,5" d="M243.73,-217.46C243.73,-255.51 243.73,-335.22 243.73,-384"/>
<polygon fill="grey" stroke="grey" points="240.23,-383.88 243.73,-393.88 247.23,-383.88 240.23,-383.88"/>
<text xml:space="preserve" text-anchor="middle" x="227.98" y="-309.68" font-family="Helvetica,sans-Serif" font-size="10.00">Read Weights</text>
<text xml:space="preserve" text-anchor="middle" x="227.98" y="-296.93" font-family="Helvetica,sans-Serif" font-size="10.00">(4.1 GB total)</text>
</g>
<!-- RMSNorm1 -->
<g id="node11" class="node">
<title>RMSNorm1</title>
<polygon fill="lightblue" stroke="black" points="448.86,-213.16 364.61,-213.16 364.61,-170.66 448.86,-170.66 448.86,-213.16"/>
<text xml:space="preserve" text-anchor="middle" x="406.73" y="-195.86" font-family="Helvetica,sans-Serif" font-size="14.00">RMSNorm</text>
<text xml:space="preserve" text-anchor="middle" x="406.73" y="-178.61" font-family="Helvetica,sans-Serif" font-size="14.00">(Attn)</text>
</g>
<!-- Embedding&#45;&gt;RMSNorm1 -->
<g id="edge8" class="edge">
<title>Embedding&#45;&gt;RMSNorm1</title>
<path fill="none" stroke="black" d="M291.73,-194.74C310.9,-194.27 333.15,-193.72 352.87,-193.23"/>
<polygon fill="black" stroke="black" points="352.73,-196.73 362.64,-192.98 352.56,-189.73 352.73,-196.73"/>
<text xml:space="preserve" text-anchor="middle" x="328.61" y="-210.27" font-family="Helvetica,sans-Serif" font-size="10.00">1x4096</text>
<text xml:space="preserve" text-anchor="middle" x="328.61" y="-197.52" font-family="Helvetica,sans-Serif" font-size="10.00">(f16)</text>
</g>
<!-- Add1 -->
<g id="node16" class="node">
<title>Add1</title>
<polygon fill="lightblue" stroke="black" points="1268.61,-214.16 1194.11,-214.16 1194.11,-171.66 1268.61,-171.66 1268.61,-214.16"/>
<text xml:space="preserve" text-anchor="middle" x="1231.36" y="-196.86" font-family="Helvetica,sans-Serif" font-size="14.00">Residual</text>
<text xml:space="preserve" text-anchor="middle" x="1231.36" y="-179.61" font-family="Helvetica,sans-Serif" font-size="14.00">Add</text>
</g>
<!-- Embedding&#45;&gt;Add1 -->
<g id="edge16" class="edge">
<title>Embedding&#45;&gt;Add1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M266.58,-217.48C306.34,-256.29 388.06,-333.91 405.73,-333.91 405.73,-333.91 405.73,-333.91 1123.48,-333.91 1177.65,-333.91 1207.9,-267.02 1221.49,-225.38"/>
<polygon fill="black" stroke="black" points="1224.75,-226.67 1224.36,-216.08 1218.06,-224.6 1224.75,-226.67"/>
<text xml:space="preserve" text-anchor="middle" x="770.61" y="-337.16" font-family="Helvetica,sans-Serif" font-size="10.00">Residual</text>
</g>
<!-- QKV -->
<g id="node12" class="node">
<title>QKV</title>
<polygon fill="lightblue" stroke="black" points="596.86,-212.16 520.86,-212.16 520.86,-169.66 596.86,-169.66 596.86,-212.16"/>
<text xml:space="preserve" text-anchor="middle" x="558.86" y="-194.86" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Proj</text>
<text xml:space="preserve" text-anchor="middle" x="558.86" y="-177.61" font-family="Helvetica,sans-Serif" font-size="14.00">(Linear)</text>
</g>
<!-- RMSNorm1&#45;&gt;QKV -->
<g id="edge9" class="edge">
<title>RMSNorm1&#45;&gt;QKV</title>
<path fill="none" stroke="black" d="M449.07,-188.96C455.03,-188.63 461.1,-188.35 466.86,-188.16 482.85,-187.66 486.86,-187.76 502.86,-188.16 504.92,-188.21 507.02,-188.28 509.15,-188.35"/>
<polygon fill="black" stroke="black" points="508.95,-191.84 519.08,-188.74 509.22,-184.85 508.95,-191.84"/>
<text xml:space="preserve" text-anchor="middle" x="484.86" y="-191.41" font-family="Helvetica,sans-Serif" font-size="10.00">1x4096</text>
</g>
<!-- QKV&#45;&gt;CPU -->
<g id="edge29" class="edge">
<title>QKV&#45;&gt;CPU</title>
<path fill="none" stroke="grey" stroke-dasharray="1,5" d="M555.24,-212.66C548.87,-261.68 531.04,-378.6 502.86,-404.91 485.02,-421.57 473.16,-412.68 448.86,-414.91 408.03,-418.66 397.37,-419.29 356.61,-414.91 335.81,-412.68 327.4,-417.39 310.61,-404.91 303.26,-399.46 308.5,-391.55 300.61,-386.91 260.1,-363.08 241.35,-380.01 194.86,-386.91 172.48,-390.23 148.57,-396.72 127.7,-403.41"/>
<polygon fill="grey" stroke="grey" points="126.61,-400.09 118.21,-406.55 128.8,-406.73 126.61,-400.09"/>
</g>
<!-- RoPE -->
<g id="node13" class="node">
<title>RoPE</title>
<polygon fill="lightblue" stroke="black" points="824.36,-212.16 716.86,-212.16 716.86,-169.66 824.36,-169.66 824.36,-212.16"/>
<text xml:space="preserve" text-anchor="middle" x="770.61" y="-194.86" font-family="Helvetica,sans-Serif" font-size="14.00">RoPE</text>
<text xml:space="preserve" text-anchor="middle" x="770.61" y="-177.61" font-family="Helvetica,sans-Serif" font-size="14.00">(Rotary Emb)</text>
</g>
<!-- QKV&#45;&gt;RoPE -->
<g id="edge10" class="edge">
<title>QKV&#45;&gt;RoPE</title>
<path fill="none" stroke="black" d="M597.13,-188.8C603.06,-188.53 609.12,-188.31 614.86,-188.16 652.18,-187.23 661.53,-187.44 698.86,-188.16 701.03,-188.2 703.23,-188.25 705.45,-188.31"/>
<polygon fill="black" stroke="black" points="705.08,-191.8 715.17,-188.59 705.28,-184.8 705.08,-191.8"/>
<text xml:space="preserve" text-anchor="middle" x="656.86" y="-191.41" font-family="Helvetica,sans-Serif" font-size="10.00">1x(32+8+8)x128</text>
</g>
<!-- Attn -->
<g id="node14" class="node">
<title>Attn</title>
<polygon fill="lightblue" stroke="black" points="1015.86,-214.16 921.86,-214.16 921.86,-171.66 1015.86,-171.66 1015.86,-214.16"/>
<text xml:space="preserve" text-anchor="middle" x="968.86" y="-196.86" font-family="Helvetica,sans-Serif" font-size="14.00">Flash/SDPA</text>
<text xml:space="preserve" text-anchor="middle" x="968.86" y="-179.61" font-family="Helvetica,sans-Serif" font-size="14.00">Attention</text>
</g>
<!-- RoPE&#45;&gt;Attn -->
<g id="edge13" class="edge">
<title>RoPE&#45;&gt;Attn</title>
<path fill="none" stroke="black" d="M824.71,-189.18C848.86,-188.66 877.81,-188.4 903.86,-189.16 905.9,-189.22 907.97,-189.29 910.07,-189.37"/>
<polygon fill="black" stroke="black" points="909.73,-192.86 919.87,-189.8 910.03,-185.87 909.73,-192.86"/>
<text xml:space="preserve" text-anchor="middle" x="873.11" y="-192.41" font-family="Helvetica,sans-Serif" font-size="10.00">q, k, v</text>
</g>
<!-- KVCache -->
<g id="node26" class="node">
<title>KVCache</title>
<polygon fill="gold" stroke="black" points="811.61,-298.16 729.61,-298.16 729.61,-255.66 811.61,-255.66 811.61,-298.16"/>
<text xml:space="preserve" text-anchor="middle" x="770.61" y="-280.86" font-family="Helvetica,sans-Serif" font-size="14.00">KV Cache</text>
<text xml:space="preserve" text-anchor="middle" x="770.61" y="-263.61" font-family="Helvetica,sans-Serif" font-size="14.00">(128 MB)</text>
</g>
<!-- RoPE&#45;&gt;KVCache -->
<g id="edge11" class="edge">
<title>RoPE&#45;&gt;KVCache</title>
<path fill="none" stroke="red" d="M770.61,-212.61C770.61,-222.09 770.61,-233.4 770.61,-243.88"/>
<polygon fill="red" stroke="red" points="767.11,-243.7 770.61,-253.7 774.11,-243.7 767.11,-243.7"/>
<text xml:space="preserve" text-anchor="middle" x="754.86" y="-237.16" font-family="Helvetica,sans-Serif" font-size="10.00">Write k,v</text>
<text xml:space="preserve" text-anchor="middle" x="754.86" y="-224.41" font-family="Helvetica,sans-Serif" font-size="10.00">(t3)</text>
</g>
<!-- Attn&#45;&gt;CPU -->
<g id="edge30" class="edge">
<title>Attn&#45;&gt;CPU</title>
<path fill="none" stroke="grey" stroke-dasharray="1,5" d="M921.66,-181.53C819.37,-157.55 578.26,-108.25 520.86,-160.91 486.51,-192.43 535.11,-336.25 502.86,-369.91 486.12,-387.39 473.01,-375.35 448.86,-376.91 407.94,-379.55 397.55,-379.1 356.61,-376.91 331.61,-375.58 325.6,-372.25 300.61,-370.91 253.68,-368.41 241.45,-364.73 194.86,-370.91 169.53,-374.28 163.02,-376.27 139.36,-385.91 131.05,-389.3 122.5,-393.46 114.35,-397.8"/>
<polygon fill="grey" stroke="grey" points="112.69,-394.71 105.61,-402.6 116.06,-400.85 112.69,-394.71"/>
</g>
<!-- O_Proj -->
<g id="node15" class="node">
<title>O_Proj</title>
<polygon fill="lightblue" stroke="black" points="1157.11,-214.16 1087.86,-214.16 1087.86,-171.66 1157.11,-171.66 1157.11,-214.16"/>
<text xml:space="preserve" text-anchor="middle" x="1122.48" y="-196.86" font-family="Helvetica,sans-Serif" font-size="14.00">O Proj</text>
<text xml:space="preserve" text-anchor="middle" x="1122.48" y="-179.61" font-family="Helvetica,sans-Serif" font-size="14.00">(Linear)</text>
</g>
<!-- Attn&#45;&gt;O_Proj -->
<g id="edge14" class="edge">
<title>Attn&#45;&gt;O_Proj</title>
<path fill="none" stroke="black" d="M1016.16,-190.6C1033.06,-190.03 1052.32,-189.7 1069.86,-190.16 1071.92,-190.22 1074.03,-190.28 1076.16,-190.36"/>
<polygon fill="black" stroke="black" points="1075.96,-193.86 1086.1,-190.79 1076.26,-186.86 1075.96,-193.86"/>
<text xml:space="preserve" text-anchor="middle" x="1051.86" y="-193.41" font-family="Helvetica,sans-Serif" font-size="10.00">1x4096</text>
</g>
<!-- O_Proj&#45;&gt;Add1 -->
<g id="edge15" class="edge">
<title>O_Proj&#45;&gt;Add1</title>
<path fill="none" stroke="black" d="M1157.59,-192.91C1165.4,-192.91 1173.84,-192.91 1182.12,-192.91"/>
<polygon fill="black" stroke="black" points="1182.1,-196.41 1192.1,-192.91 1182.1,-189.41 1182.1,-196.41"/>
</g>
<!-- RMSNorm2 -->
<g id="node17" class="node">
<title>RMSNorm2</title>
<polygon fill="lightblue" stroke="black" points="1389.86,-169.16 1305.61,-169.16 1305.61,-126.66 1389.86,-126.66 1389.86,-169.16"/>
<text xml:space="preserve" text-anchor="middle" x="1347.73" y="-151.86" font-family="Helvetica,sans-Serif" font-size="14.00">RMSNorm</text>
<text xml:space="preserve" text-anchor="middle" x="1347.73" y="-134.61" font-family="Helvetica,sans-Serif" font-size="14.00">(FFN)</text>
</g>
<!-- Add1&#45;&gt;RMSNorm2 -->
<g id="edge17" class="edge">
<title>Add1&#45;&gt;RMSNorm2</title>
<path fill="none" stroke="black" d="M1268.86,-178.55C1277.14,-175.3 1286.08,-171.78 1294.85,-168.33"/>
<polygon fill="black" stroke="black" points="1295.98,-171.64 1304,-164.73 1293.41,-165.13 1295.98,-171.64"/>
</g>
<!-- Add2 -->
<g id="node21" class="node">
<title>Add2</title>
<polygon fill="lightblue" stroke="black" points="1790.11,-202.16 1715.61,-202.16 1715.61,-159.66 1790.11,-159.66 1790.11,-202.16"/>
<text xml:space="preserve" text-anchor="middle" x="1752.86" y="-184.86" font-family="Helvetica,sans-Serif" font-size="14.00">Residual</text>
<text xml:space="preserve" text-anchor="middle" x="1752.86" y="-167.61" font-family="Helvetica,sans-Serif" font-size="14.00">Add</text>
</g>
<!-- Add1&#45;&gt;Add2 -->
<g id="edge23" class="edge">
<title>Add1&#45;&gt;Add2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1268.87,-197.25C1291.3,-199.56 1320.64,-201.91 1346.73,-201.91 1346.73,-201.91 1346.73,-201.91 1635.98,-201.91 1658.58,-201.91 1683.27,-198 1704.02,-193.55"/>
<polygon fill="black" stroke="black" points="1704.66,-196.99 1713.64,-191.38 1703.11,-190.17 1704.66,-196.99"/>
<text xml:space="preserve" text-anchor="middle" x="1467.11" y="-205.16" font-family="Helvetica,sans-Serif" font-size="10.00">Residual</text>
</g>
<!-- MLP_Gate -->
<g id="node18" class="node">
<title>MLP_Gate</title>
<polygon fill="lightblue" stroke="black" points="1507.36,-112.16 1426.86,-112.16 1426.86,-69.66 1507.36,-69.66 1507.36,-112.16"/>
<text xml:space="preserve" text-anchor="middle" x="1467.11" y="-94.86" font-family="Helvetica,sans-Serif" font-size="14.00">MLP Gate</text>
<text xml:space="preserve" text-anchor="middle" x="1467.11" y="-77.61" font-family="Helvetica,sans-Serif" font-size="14.00">(SiLU)</text>
</g>
<!-- RMSNorm2&#45;&gt;MLP_Gate -->
<g id="edge18" class="edge">
<title>RMSNorm2&#45;&gt;MLP_Gate</title>
<path fill="none" stroke="black" d="M1390.12,-127.82C1398.65,-123.67 1407.73,-119.26 1416.53,-114.99"/>
<polygon fill="black" stroke="black" points="1417.85,-118.24 1425.31,-110.72 1414.79,-111.94 1417.85,-118.24"/>
</g>
<!-- MLP_Up -->
<g id="node19" class="node">
<title>MLP_Up</title>
<polygon fill="lightblue" stroke="black" points="1500.98,-165.91 1433.23,-165.91 1433.23,-129.91 1500.98,-129.91 1500.98,-165.91"/>
<text xml:space="preserve" text-anchor="middle" x="1467.11" y="-143.24" font-family="Helvetica,sans-Serif" font-size="14.00">MLP Up</text>
</g>
<!-- RMSNorm2&#45;&gt;MLP_Up -->
<g id="edge19" class="edge">
<title>RMSNorm2&#45;&gt;MLP_Up</title>
<path fill="none" stroke="black" d="M1390.12,-147.91C1400.28,-147.91 1411.21,-147.91 1421.52,-147.91"/>
<polygon fill="black" stroke="black" points="1421.31,-151.41 1431.31,-147.91 1421.31,-144.41 1421.31,-151.41"/>
</g>
<!-- MLP_Down -->
<g id="node20" class="node">
<title>MLP_Down</title>
<polygon fill="lightblue" stroke="black" points="1678.61,-165.91 1591.36,-165.91 1591.36,-129.91 1678.61,-129.91 1678.61,-165.91"/>
<text xml:space="preserve" text-anchor="middle" x="1634.98" y="-143.24" font-family="Helvetica,sans-Serif" font-size="14.00">MLP Down</text>
</g>
<!-- MLP_Gate&#45;&gt;MLP_Down -->
<g id="edge20" class="edge">
<title>MLP_Gate&#45;&gt;MLP_Down</title>
<path fill="none" stroke="black" d="M1507.84,-104.57C1529.52,-112.01 1556.66,-121.34 1580.21,-129.43"/>
<polygon fill="black" stroke="black" points="1579.06,-132.74 1589.66,-132.68 1581.34,-126.12 1579.06,-132.74"/>
<text xml:space="preserve" text-anchor="middle" x="1549.36" y="-129.44" font-family="Helvetica,sans-Serif" font-size="10.00">Gate * Up</text>
</g>
<!-- MLP_Up&#45;&gt;MLP_Down -->
<!-- MLP_Down&#45;&gt;CPU -->
<g id="edge31" class="edge">
<title>MLP_Down&#45;&gt;CPU</title>
<path fill="none" stroke="grey" stroke-dasharray="1,5" d="M1615.38,-129.61C1592.29,-108.31 1550.66,-74.36 1507.36,-60.91 1473.19,-50.31 1462.61,-59.47 1426.86,-60.91 1023.21,-77.15 829.45,126.78 520.86,-133.91 495.99,-154.92 519.86,-177.15 502.86,-204.91 454.61,-283.67 430.67,-303.66 346.61,-341.91 262.01,-380.41 224.92,-333.61 139.36,-369.91 138.81,-370.15 122.36,-383.13 105.58,-396.42"/>
<polygon fill="grey" stroke="grey" points="103.71,-393.43 98.05,-402.39 108.06,-398.92 103.71,-393.43"/>
</g>
<!-- MLP_Down&#45;&gt;Add2 -->
<g id="edge22" class="edge">
<title>MLP_Down&#45;&gt;Add2</title>
<path fill="none" stroke="black" d="M1678.8,-160.11C1687.14,-162.48 1695.93,-164.98 1704.4,-167.4"/>
<polygon fill="black" stroke="black" points="1703.27,-170.72 1713.85,-170.09 1705.19,-163.98 1703.27,-170.72"/>
</g>
<!-- NormFinal -->
<g id="node22" class="node">
<title>NormFinal</title>
<polygon fill="lightblue" stroke="black" points="1911.36,-202.16 1827.11,-202.16 1827.11,-159.66 1911.36,-159.66 1911.36,-202.16"/>
<text xml:space="preserve" text-anchor="middle" x="1869.23" y="-184.86" font-family="Helvetica,sans-Serif" font-size="14.00">RMSNorm</text>
<text xml:space="preserve" text-anchor="middle" x="1869.23" y="-167.61" font-family="Helvetica,sans-Serif" font-size="14.00">(Final)</text>
</g>
<!-- Add2&#45;&gt;NormFinal -->
<g id="edge24" class="edge">
<title>Add2&#45;&gt;NormFinal</title>
<path fill="none" stroke="black" d="M1790.36,-180.91C1798.36,-180.91 1806.99,-180.91 1815.48,-180.91"/>
<polygon fill="black" stroke="black" points="1815.4,-184.41 1825.4,-180.91 1815.4,-177.41 1815.4,-184.41"/>
</g>
<!-- LM_Head -->
<g id="node23" class="node">
<title>LM_Head</title>
<polygon fill="lightyellow" stroke="black" points="2059.36,-202.16 1983.36,-202.16 1983.36,-159.66 2059.36,-159.66 2059.36,-202.16"/>
<text xml:space="preserve" text-anchor="middle" x="2021.36" y="-184.86" font-family="Helvetica,sans-Serif" font-size="14.00">LM Head</text>
<text xml:space="preserve" text-anchor="middle" x="2021.36" y="-167.61" font-family="Helvetica,sans-Serif" font-size="14.00">(Linear)</text>
</g>
<!-- NormFinal&#45;&gt;LM_Head -->
<g id="edge25" class="edge">
<title>NormFinal&#45;&gt;LM_Head</title>
<path fill="none" stroke="black" d="M1911.65,-180.91C1930.21,-180.91 1952.23,-180.91 1971.58,-180.91"/>
<polygon fill="black" stroke="black" points="1971.41,-184.41 1981.41,-180.91 1971.41,-177.41 1971.41,-184.41"/>
<text xml:space="preserve" text-anchor="middle" x="1947.36" y="-184.16" font-family="Helvetica,sans-Serif" font-size="10.00">1x4096</text>
</g>
<!-- Sampler -->
<g id="node24" class="node">
<title>Sampler</title>
<polygon fill="lightgreen" stroke="black" points="2257.44,-180.91 2226.11,-215.61 2163.44,-215.61 2132.11,-180.91 2163.44,-146.21 2226.11,-146.21 2257.44,-180.91"/>
<text xml:space="preserve" text-anchor="middle" x="2194.78" y="-184.86" font-family="Helvetica,sans-Serif" font-size="14.00">Sampler</text>
<text xml:space="preserve" text-anchor="middle" x="2194.78" y="-167.61" font-family="Helvetica,sans-Serif" font-size="14.00">(Top&#45;K/P)</text>
</g>
<!-- LM_Head&#45;&gt;Sampler -->
<g id="edge26" class="edge">
<title>LM_Head&#45;&gt;Sampler</title>
<path fill="none" stroke="black" d="M2059.55,-180.91C2077.33,-180.91 2099.27,-180.91 2120.21,-180.91"/>
<polygon fill="black" stroke="black" points="2120.2,-184.41 2130.2,-180.91 2120.2,-177.41 2120.2,-184.41"/>
<text xml:space="preserve" text-anchor="middle" x="2095.73" y="-196.91" font-family="Helvetica,sans-Serif" font-size="10.00">1x32k</text>
<text xml:space="preserve" text-anchor="middle" x="2095.73" y="-184.16" font-family="Helvetica,sans-Serif" font-size="10.00">(Logits)</text>
</g>
<!-- NextToken -->
<g id="node25" class="node">
<title>NextToken</title>
<ellipse fill="white" stroke="black" cx="2359.32" cy="-180.91" rx="64.88" ry="64.88"/>
<text xml:space="preserve" text-anchor="middle" x="2359.32" y="-184.86" font-family="Helvetica,sans-Serif" font-size="14.00">Next Token</text>
<text xml:space="preserve" text-anchor="middle" x="2359.32" y="-167.61" font-family="Helvetica,sans-Serif" font-size="14.00">(i32)</text>
</g>
<!-- Sampler&#45;&gt;NextToken -->
<g id="edge27" class="edge">
<title>Sampler&#45;&gt;NextToken</title>
<path fill="none" stroke="black" d="M2257.69,-180.91C2265.89,-180.91 2274.38,-180.91 2282.78,-180.91"/>
<polygon fill="black" stroke="black" points="2282.63,-184.41 2292.63,-180.91 2282.63,-177.41 2282.63,-184.41"/>
</g>
<!-- KVCache&#45;&gt;RAM -->
<g id="edge32" class="edge">
<title>KVCache&#45;&gt;RAM</title>
<path fill="none" stroke="grey" stroke-dasharray="1,5" d="M735.32,-298.47C674.44,-336.53 549.5,-413.62 502.86,-434.91 479.85,-445.42 473.83,-448.86 448.86,-452.91 408.39,-459.48 397.3,-457.93 356.61,-452.91 339.25,-450.77 320.71,-446.83 303.81,-442.57"/>
<polygon fill="grey" stroke="grey" points="305,-439.26 294.44,-440.12 303.23,-446.04 305,-439.26"/>
</g>
<!-- KVCache&#45;&gt;Attn -->
<g id="edge12" class="edge">
<title>KVCache&#45;&gt;Attn</title>
<path fill="none" stroke="blue" d="M811.8,-259.71C840.41,-247.46 879.26,-230.83 911.04,-217.23"/>
<polygon fill="blue" stroke="blue" points="912.32,-220.49 920.13,-213.34 909.56,-214.06 912.32,-220.49"/>
<text xml:space="preserve" text-anchor="middle" x="873.11" y="-260.91" font-family="Helvetica,sans-Serif" font-size="10.00">Read history</text>
<text xml:space="preserve" text-anchor="middle" x="873.11" y="-248.16" font-family="Helvetica,sans-Serif" font-size="10.00">(1024 ctx)</text>
</g>
</g>
</svg>
